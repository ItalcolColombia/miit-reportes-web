# Docker Compose para MIIT Reportes Web
# Uso:
#   Desarrollo:  docker-compose up --build
#   Produccion:  docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

version: '3.8'

services:
  miit-reportes-web:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - VITE_API_BASE_URL=${VITE_API_BASE_URL:-http://localhost:8000/api/v1}
        - VITE_APP_NAME=${VITE_APP_NAME:-MIIT Reportes}
        - VITE_APP_VERSION=${VITE_APP_VERSION:-1.0.0}
        - VITE_APP_ENV=${VITE_APP_ENV:-production}
    image: miit-reportes-web:${APP_VERSION:-latest}
    container_name: miit-reportes-web
    restart: unless-stopped
    ports:
      - "${WEB_PORT:-80}:80"
    environment:
      - API_BACKEND_URL=${API_BACKEND_URL:-http://backend:8000}
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    networks:
      - miit-network
    labels:
      - "com.miit.service=web"
      - "com.miit.environment=${VITE_APP_ENV:-production}"

networks:
  miit-network:
    driver: bridge
    name: miit-network
